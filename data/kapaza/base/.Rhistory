fileConn <- file(paste0(url,".txt"))
writeLines(html, fileConn)
close(fileConn)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions.RData")
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
fileConn <- file(paste0(url,".txt"))
writeLines(html, fileConn)
close(fileConn)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
rm(urls)
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
return(html)
# write to text
setwd(save_path)
fileConn <- file(paste0(url,".txt"))
writeLines(html, fileConn)
close(fileConn)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test <- lapply(test_urls, scrape)
test[[1]]
test[[1]][[2]]
test[[1]]
test[[1]][2]
test[[1]][1]
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
return(html)
# write to text
setwd(save_path)
fileConn <- file(paste0(url,".txt"))
writeLines(html, fileConn)
close(fileConn)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
test <- lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
fileConn <- file(paste0(url,".txt"))
writeLines(html, fileConn)
close(fileConn)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
test <- lapply(test_urls, scrape)
?saveXML
?write_xml
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
write_xml(x = html, file = save_path)
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
test <- lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
write_xml(x = html, file = paste0(save_path, "\\", url, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
test <- lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
write_xml(x = html, file = paste0(save_path, "\\", "lol", ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
write_xml(x = html, file = paste0(save_path, "\\", "lol", ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
return(wait_times)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
?Sys.sleep
?sample
sample(1:5, 1)
sample(1:5, 1)
sample(1:5, 1)
sample(1:5, 1)
test_urls[2]
str_split(test_urls[2], split = "/")
str_split(test_urls[2], split = "//")
?str_split
str_split(test_urls[2], "/")
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", "lol", ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
return(wait_times)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
write_xml(x = html, file = paste0(save_path, "\\", "lol", ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, n = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
sample(1:5, n = 1)
?sample
sample(1:5, size = 1)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
write_xml(x = html, file = paste0(save_path, "\\", "lol", ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
rm(list )
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
?gsub
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "/?o=", replacement = "_", x = filename)
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\?o=", replacement = "_", x = filename)
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\?o=", replacement = "_", x = filename)
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
return(filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=131",
"http://www.kapaza.be/nl/mercedes-benz?o=130")
lapply(test_urls, scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
rm(list = ls())
### set-up
## packages
library(rvest)
library(dplyr)
## project path
project_path <- "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage"
## load
# posts
posts <- read.csv(file = paste0(project_path,
"\\output\\scraping\\brand_popularity\\posts_by_brand.csv"))
load(paste0(project_path, "\\functions\\scrape.RData"))
View(scrape)
View(scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_html = FALSE,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
if(save_html == TRUE) {
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
}
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
rm(list = ls())
test_urls <- c("http://www.kapaza.be/nl/mercedes-benz?o=130",
"http://www.kapaza.be/nl/mercedes-benz?o=131")
load(paste0(project_path, "\\functions\\scrape.RData"))
project_path <- "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage"
load(paste0(project_path, "\\functions\\scrape.RData"))
View(scrape)
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_html = FALSE,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
if(save_html == TRUE) {
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
}
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
load(paste0(project_path, "\\functions\\scrape.RData"))
View(scrape)
lapply(test_urls, scrape)
lapply(test_urls, function(x) scrape(url = x, save_html = TRUE))
scrape <- function(url,
time_between_requests = 10,
randomization_requests = 3,
save_html = FALSE,
save_path = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\data\\kapaza\\base") {
# packages
library(rvest)
# read html
html <- read_html(url)
# write to text
if(save_html == TRUE) {
setwd(save_path)
filename <- sapply(str_split(url, "/"), function(x) x[length(x)])
filename <- gsub(pattern = "\\?o=", replacement = "_", x = filename)
write_xml(x = html, file = paste0(save_path, "\\", filename, ".xml"))
}
# wait
wait_times <- rnorm(n = 1000,
mean = time_between_requests,
sd = time_between_requests/randomization_requests)
Sys.sleep(time = sample(x = wait_times, size = 1)) }
save(scrape, file = "C:\\Users\\Felix Timmermans\\Desktop\\cars_arbitrage\\functions\\scrape.RData")
